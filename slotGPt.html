<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link href="https://fonts.googleapis.com/css2?family=Bungee+Spice&display=swap" rel="stylesheet">

    <title>Chinese New Year Mahjong Slot</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #8B0000, #B22222, #8B0000);
            color: #FFD700;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow-x: hidden;
            position: relative;
            padding: 10px;
        }

        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><path fill="%23FFD700" opacity="0.1" d="M20,20 C30,10 70,10 80,20 C90,30 90,70 80,80 C70,90 30,90 20,80 C10,70 10,30 20,20 Z"/></svg>');
            z-index: -1;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            padding: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        header {
            text-align: center;
            margin-bottom: 20px;
            z-index: 10;
            position: relative;
        }

        h1 {
            font-size: clamp(1.5rem, 5vw, 4rem);
            color: #FFD700;
            text-shadow: 0 0 10px #FF4500, 0 0 20px #FF0000;
            margin-bottom: 10px;
            letter-spacing: 2px;
            font-weight: bold;
        }

        .subtitle {
            font-size: clamp(0.9rem, 3vw, 1.5rem);
            color: #FFEBCD;
            margin-bottom: 15px;
            text-shadow: 0 0 5px #8B0000;
        }

        .slot-machine {
            width: 100%;
            max-width: 900px;
            min-height: 500px;
            background: linear-gradient(145deg, #8B0000, #A52A2A);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.7),
                inset 0 0 20px rgba(255, 215, 0, 0.3);
            padding: 15px;
            display: flex;
            flex-direction: column;
            position: relative;
            overflow: hidden;
            border: 4px solid #FFD700;
        }

        .slot-machine::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><path fill="%23FFD700" opacity="0.1" d="M0,0 L100,0 L100,100 L0,100 Z M10,10 L90,10 L90,90 L10,90 Z"/></svg>');
            opacity: 0.1;
            z-index: 1;
        }

        .reels-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: clamp(8px, 2vw, 15px);
            height: clamp(250px, 50vw, 400px);
            margin-bottom: 15px;
            position: relative;
            z-index: 2;
        }

        .reel {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            overflow: hidden;
            position: relative;
            box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.5),
                0 5px 15px rgba(0, 0, 0, 0.5);
            perspective: 1000px;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 60px;
        }

        .reel-inner {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.1s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .tile {
            width: 100%;
            height: 100%;
            position: absolute;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: clamp(2rem, 5vw, 4rem);
            backface-visibility: hidden;
            border-radius: 8px;
            background: linear-gradient(145deg, #FFF8DC, #FFEBCD);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            transform: rotateX(0deg);
            transition: transform 0.5s;
            border: 2px solid #8B0000;
        }

        .tile.scatter {
            background: linear-gradient(145deg, #FFD700, #FFA500);
            color: #8B0000;
        }

        .tile.wild {
            background: linear-gradient(145deg, #32CD32, #228B22);
            color: #FFD700;
        }

        .tile.jackpot {
            background: linear-gradient(145deg, #FF0000, #8B0000);
            color: #FFD700;
        }

        .tile-image {
            width: 90%;
            height: 90%;
            object-fit: contain;
            border-radius: 6px;
            transition: transform 0.2s ease;
        }

        .tile-image:hover {
            transform: scale(1.1);
        }

        .win-effect-container {
            position: fixed;
            top: 40%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            animation: popUp 0.5s ease-out;
            z-index: 9999;
        }

        .win-text {
            color: #FFD700;
            font-size: clamp(1.5rem, 5vw, 2rem);
            font-weight: bold;
            text-shadow: 0 0 10px #ffcc00;
            margin-top: 10px;
        }

        @keyframes popUp {
            from {
                transform: translate(-50%, -50%) scale(0.5);
                opacity: 0;
            }

            to {
                transform: translate(-50%, -50%) scale(1);
                opacity: 1;
            }
        }

        .win-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            z-index: 9999;
            animation: fadeIn 0.3s ease;
        }

        .win-effect-img {
            position: absolute;
            width: 100%;
            height: 100%;
            object-fit: cover;
            opacity: 0.4;
            z-index: 1;
        }

        .win-text {
            position: relative;
            z-index: 2;
            font-family: 'Bungee Spice', cursive;
            font-size: clamp(2rem, 8vw, 4rem);
            text-align: center;
            color: gold;
            text-shadow: 0 0 20px #ff0000, 0 0 40px #ff6600, 0 0 60px #ffff00;
            animation: pop 0.8s ease-out, glow 1.5s infinite alternate;
            padding: 20px;
        }

        .win-amount {
            display: block;
            font-size: clamp(1.5rem, 6vw, 3rem);
            color: #fffa65;
            text-shadow: 0 0 15px #ff0000, 0 0 25px #ff6600;
        }

        @keyframes pop {
            0% {
                transform: scale(0);
                opacity: 0;
            }

            60% {
                transform: scale(1.3);
                opacity: 1;
            }

            100% {
                transform: scale(1);
            }
        }

        @keyframes glow {
            from {
                text-shadow: 0 0 20px #ff0, 0 0 40px #f80;
            }

            to {
                text-shadow: 0 0 40px #f00, 0 0 60px #ff0;
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        .fade-out {
            animation: fadeOut 1s forwards;
        }

        @keyframes fadeOut {
            to {
                opacity: 0;
            }
        }

        @keyframes comboZoom {
            0% {
                transform: scale(1);
                filter: brightness(1);
            }

            30% {
                transform: scale(1.3);
                filter: brightness(1.8) drop-shadow(0 0 20px red);
            }

            60% {
                transform: scale(1.1);
                filter: brightness(1.4);
            }

            100% {
                transform: scale(1);
                filter: brightness(1);
            }
        }

        .combo-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: radial-gradient(circle at center, rgba(255, 0, 0, 0.25), rgba(0, 0, 0, 0.9)),
                url('assets/effects/olympus_bg.jpg') center/cover no-repeat;
            z-index: 90;
            opacity: 0;
            transition: opacity 0.4s ease;
            pointer-events: none;
        }

        .combo-bg.active {
            opacity: 1;
            animation: flicker 1.2s infinite alternate;
        }

        @keyframes redFlash {

            0%,
            100% {
                filter: brightness(1) drop-shadow(0 0 0px red);
            }

            50% {
                filter: brightness(1.8) drop-shadow(0 0 20px red);
            }
        }

        .combo-spark {
            position: absolute;
            width: 10px;
            height: 10px;
            background: radial-gradient(circle, #ff0000, transparent);
            border-radius: 50%;
            animation: sparkFly 0.6s ease-out forwards;
            z-index: 200;
        }

        @keyframes sparkFly {
            from {
                transform: scale(1) translate(0, 0);
                opacity: 1;
            }

            to {
                transform: scale(0) translate(var(--x), var(--y));
                opacity: 0;
            }
        }

        @keyframes flicker {
            0% {
                filter: brightness(1);
            }

            50% {
                filter: brightness(1.4);
            }

            100% {
                filter: brightness(1);
            }
        }

        .controls {
            display: flex;
            flex-direction: column;
            gap: 15px;
            align-items: center;
            z-index: 2;
            margin-top: 15px;
            width: 100%;
        }

        .info-panel {
            display: flex;
            flex-direction: column;
            align-items: center;
            background: rgba(0, 0, 0, 0.4);
            padding: 15px 20px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            border: 2px solid #FFD700;
            width: 100%;
            max-width: 350px;
        }

        .balance,
        .bet {
            font-size: clamp(1.1rem, 3vw, 1.5rem);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }

        .balance span,
        .bet span {
            color: #FFD700;
            font-weight: bold;
            margin-left: 10px;
        }

        .bet-controls {
            display: flex;
            align-items: center;
            margin-top: 10px;
        }

        .bet-btn {
            width: clamp(40px, 10vw, 50px);
            height: clamp(40px, 10vw, 50px);
            border-radius: 50%;
            background: linear-gradient(145deg, #8B0000, #A52A2A);
            color: #FFD700;
            border: 2px solid #FFD700;
            font-size: clamp(1.2rem, 4vw, 1.8rem);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 10px;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.3);
            touch-action: manipulation;
        }

        .bet-btn:active {
            background: linear-gradient(145deg, #A52A2A, #8B0000);
            transform: scale(0.95);
        }

        .spin-control {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
            width: 100%;
        }

        .spin-btn {
            padding: clamp(15px, 4vw, 20px) clamp(40px, 10vw, 50px);
            font-size: clamp(1.3rem, 4vw, 1.8rem);
            font-weight: bold;
            background: linear-gradient(145deg, #FF4500, #FF0000);
            color: #FFD700;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(255, 69, 0, 0.5);
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 2px;
            touch-action: manipulation;
            width: 100%;
            max-width: 300px;
        }

        .spin-btn:active {
            transform: translateY(2px) scale(0.98);
            box-shadow: 0 3px 10px rgba(255, 69, 0, 0.5);
        }

        .spin-btn:disabled {
            background: linear-gradient(145deg, #666, #444);
            box-shadow: none;
            cursor: not-allowed;
            transform: none;
        }

        .auto-btn {
            padding: clamp(12px, 3vw, 15px) clamp(30px, 8vw, 40px);
            font-size: clamp(1rem, 3vw, 1.2rem);
            font-weight: bold;
            background: linear-gradient(145deg, #006400, #228B22);
            color: #FFD700;
            border: none;
            border-radius: 40px;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0, 255, 0, 0.4);
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
            touch-action: manipulation;
            width: 100%;
            max-width: 300px;
        }

        .auto-btn:active {
            transform: translateY(2px) scale(0.98);
            box-shadow: 0 3px 10px rgba(0, 255, 0, 0.3);
        }

        .auto-btn.active {
            background: linear-gradient(145deg, #FFD700, #FFA500);
            color: #8B0000;
            box-shadow: 0 0 20px #FFD700;
        }

        .paytable {
            margin-top: 20px;
            width: 100%;
            max-width: 900px;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 15px;
            padding: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            border: 2px solid #FFD700;
        }

        .paytable h2 {
            color: #FFD700;
            text-align: center;
            margin-bottom: 15px;
            font-size: clamp(1.3rem, 4vw, 2rem);
        }

        .paytable-items {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
        }

        .paytable-item {
            display: flex;
            align-items: center;
            background: rgba(255, 215, 0, 0.1);
            padding: 12px;
            border-radius: 10px;
            border: 1px solid #FFD700;
        }

        .paytable-symbol {
            font-size: clamp(2rem, 5vw, 3rem);
            margin-right: 12px;
            width: clamp(50px, 15vw, 70px);
            height: clamp(50px, 15vw, 70px);
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            background: linear-gradient(145deg, #FFF8DC, #FFEBCD);
            border: 2px solid #8B0000;
            flex-shrink: 0;
        }

        .paytable-details {
            flex: 1;
        }

        .paytable-name {
            font-weight: bold;
            font-size: clamp(0.9rem, 2.5vw, 1.2rem);
            color: #FFEBCD;
        }

        .paytable-payout {
            color: #FFD700;
            font-weight: bold;
            font-size: clamp(0.85rem, 2.2vw, 1.1rem);
        }

        .chinese-ornament {
            position: absolute;
            width: clamp(50px, 10vw, 100px);
            height: clamp(50px, 10vw, 100px);
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="%23FFD700" d="M50,10 C70,10 90,30 90,50 C90,70 70,90 50,90 C30,90 10,70 10,50 C10,30 30,10 50,10 Z M50,30 C40,30 30,40 30,50 C30,60 40,70 50,70 C60,70 70,60 70,50 C70,40 60,30 50,30 Z"/></svg>');
            opacity: 0.3;
            z-index: 1;
        }

        .ornament-top-left {
            top: 5px;
            left: 5px;
        }

        .ornament-top-right {
            top: 5px;
            right: 5px;
        }

        .ornament-bottom-left {
            bottom: 5px;
            left: 5px;
        }

        .ornament-bottom-right {
            bottom: 5px;
            right: 5px;
        }

        footer {
            margin-top: 20px;
            text-align: center;
            color: #FFEBCD;
            font-size: clamp(0.8rem, 2vw, 1rem);
            padding: 0 15px;
        }

        .sound-controls {
            position: fixed;
            top: 15px;
            right: 15px;
            display: flex;
            flex-direction: column;
            gap: 8px;
            z-index: 9999;
        }

        .sound-btn {
            background: rgba(255, 0, 0, 0.8);
            color: white;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            padding: clamp(6px, 2vw, 8px) clamp(10px, 3vw, 12px);
            cursor: pointer;
            box-shadow: 0 0 8px rgba(0, 0, 0, 0.3);
            transition: 0.2s ease;
            font-size: clamp(0.8rem, 2vw, 1rem);
            touch-action: manipulation;
        }

        .sound-btn:active {
            background: rgba(255, 100, 0, 1);
            transform: scale(0.95);
        }

        @media (max-width: 768px) {
            body {
                padding: 5px;
            }

            .container {
                padding: 5px;
            }

            .slot-machine {
                padding: 12px;
                border-width: 3px;
            }

            .reels-container {
                gap: 8px;
            }

            .controls {
                gap: 12px;
            }

            .paytable {
                padding: 12px;
            }

            .paytable-items {
                grid-template-columns: 1fr;
                gap: 10px;
            }
        }

        @media (max-width: 480px) {
            h1 {
                letter-spacing: 1px;
            }

            .slot-machine {
                padding: 10px;
                border-width: 2px;
                border-radius: 12px;
            }

            .reels-container {
                gap: 6px;
            }

            .reel {
                border-radius: 8px;
            }

            .tile {
                border-radius: 6px;
            }

            .info-panel {
                padding: 12px 15px;
            }

            .chinese-ornament {
                display: none;
            }
        }

        @media (orientation: landscape) and (max-height: 600px) {
            .container {
                padding: 5px;
            }

            header {
                margin-bottom: 10px;
            }

            .subtitle {
                margin-bottom: 8px;
            }

            .slot-machine {
                padding: 10px;
            }

            .reels-container {
                height: 35vh;
                margin-bottom: 10px;
            }

            .controls {
                margin-top: 8px;
                gap: 8px;
            }

            .paytable {
                margin-top: 15px;
            }

            footer {
                margin-top: 15px;
                font-size: 0.8rem;
            }
        }

        .win-highlight {
            animation: winHighlight 1s ease-in-out;
        }

        @keyframes winHighlight {
            0% {
                box-shadow: 0 0 0 0 rgba(255, 215, 0, 0.7);
            }

            70% {
                box-shadow: 0 0 0 20px rgba(255, 215, 0, 0);
            }

            100% {
                box-shadow: 0 0 0 0 rgba(255, 215, 0, 0);
            }
        }

        .tile-break {
            animation: tileBreak 0.5s ease-out forwards;
        }

        @keyframes tileBreak {
            0% {
                transform: rotateX(0deg) scale(1);
                opacity: 1;
            }

            50% {
                transform: rotateX(90deg) scale(1.2);
                opacity: 0.7;
            }

            100% {
                transform: rotateX(0deg) scale(1);
                opacity: 1;
            }
        }
    </style>
    <link rel="icon" type="image/png" href="assets/tile1.jpg">

</head>

<body>
    <div class="container">
        <header>
            <h1>GUY FORTUNE SLOTS</h1>
            <p class="subtitle">Selamat Tahun Baru Imlek! Raih keberuntungan Anda!</p>
        </header>

        <div class="slot-machine">
            <div class="chinese-ornament ornament-top-left"></div>
            <div class="chinese-ornament ornament-top-right"></div>
            <div class="chinese-ornament ornament-bottom-left"></div>
            <div class="chinese-ornament ornament-bottom-right"></div>

            <div class="reels-container" id="reelsContainer">
                <!-- Reels will be generated by JavaScript -->
            </div>

            <div class="controls">
                <div class="info-panel">
                    <div class="balance">ðŸ’° Saldo: <span id="balance">1000</span></div>
                    <div class="bet">ðŸŽ¯ Taruhan: <span id="bet">10</span></div>
                    <div class="bet-controls">
                        <button class="bet-btn" id="decreaseBet">-</button>
                        <button class="bet-btn" id="increaseBet">+</button>
                    </div>
                </div>

                <div class="spin-control">
                    <button class="spin-btn" id="spinBtn">PUTAR!</button>
                    <button class="auto-btn" id="autoSpinBtn">AUTO SPIN</button>
                </div>
            </div>
        </div>

        <div class="paytable">
            <h2>Tabel Pembayaran</h2>
            <div class="paytable-items">
                <!-- Paytable items will be generated by JavaScript -->
            </div>
        </div>

        <footer>
            <p>Â© 2025 Fortune Slots - Semoga beruntung di Tahun Baru Imlek!</p>
        </footer>
    </div>

    <script>
        function formatRupiah(amount) {
            return new Intl.NumberFormat('id-ID', { style: 'currency', currency: 'IDR' }).format(amount);
        }

        let stopSpin = false;
        let balance = 1000000;
        let currentBet = 2000;
        let isSpinning = false;
        let autoSpinActive = false;
        let autoSpinInterval = null;
        const CHANCE_TO_WIN = 0.2;

        let tiles = [
            'assets/tile1.jpg',
            'assets/tile2.jpg',
            'assets/tile3.jpg',
            'assets/tile4.jpg',
            'assets/tile5.jpg',
            'assets/tile6.jpg'
        ];

        let scatterSymbol = 'assets/scatter.jpg';
        let wildSymbol = 'assets/wild.jpg';
        let jackpotSymbol = 'assets/jackpot.jpg';

        const PAYLINES = [
            [0, 1, 2],
            [3, 4, 5],
            [6, 7, 8],
            [0, 3, 6],
            [1, 4, 7],
            [2, 5, 8],
            [0, 4, 8],
            [2, 4, 6]
        ];

        const balanceElement = document.getElementById('balance');
        const betElement = document.getElementById('bet');
        const spinBtn = document.getElementById('spinBtn');
        const decreaseBetBtn = document.getElementById('decreaseBet');
        const increaseBetBtn = document.getElementById('increaseBet');
        const reelsContainer = document.getElementById('reelsContainer');
        const autoSpinBtn = document.getElementById('autoSpinBtn');

        const sounds = {
            bgm: new Audio('assets/bgm.mp3'),
            spin: new Audio('assets/spin.mp3'),
            jackpot: new Audio('assets/jackpot.mp3'),
            scatter: new Audio('assets/scatter.mp3'),
            win: new Audio('assets/jackpot.mp3')
        };

        sounds.bgm.loop = true;
        sounds.bgm.volume = 0.3;
        sounds.spin.volume = 0.7;
        sounds.jackpot.volume = 0.9;
        sounds.scatter.volume = 0.8;
        sounds.win.volume = 0.8;

        let musicEnabled = true;
        let sfxEnabled = true;

        function playSound(name) {
            if (!sounds[name]) return;
            if (!sfxEnabled && name !== 'bgm') return;
            sounds[name].currentTime = 0;
            sounds[name].play().catch(err => {
                console.log(`Audio ${name} gagal dimainkan:`, err);
            });
        }

        document.addEventListener('DOMContentLoaded', () => {
            const soundContainer = document.createElement('div');
            soundContainer.className = 'sound-controls';
            soundContainer.innerHTML = `
                <button id="toggleBgm" class="sound-btn">ðŸŽµ Music</button>
                <button id="toggleSfx" class="sound-btn">ðŸ”Š SFX</button>
            `;
            document.body.appendChild(soundContainer);

            document.getElementById('toggleBgm').addEventListener('click', () => {
                musicEnabled = !musicEnabled;
                if (musicEnabled) {
                    sounds.bgm.play();
                    document.getElementById('toggleBgm').textContent = 'ðŸŽµ Music ON';
                } else {
                    sounds.bgm.pause();
                    document.getElementById('toggleBgm').textContent = 'ðŸŽµ Music OFF';
                }
            });

            document.getElementById('toggleSfx').addEventListener('click', () => {
                sfxEnabled = !sfxEnabled;
                document.getElementById('toggleSfx').textContent = sfxEnabled ? 'ðŸ”Š SFX ON' : 'ðŸ”‡ SFX OFF';
            });
        });

        function initGame() {
            updateDisplay();
            generatePaytable();
            initializeReels();

            spinBtn.addEventListener('click', spinReels);
            decreaseBetBtn.addEventListener('click', () => changeBet(-1000));
            increaseBetBtn.addEventListener('click', () => changeBet(1000));

            autoSpinBtn.addEventListener("click", () => {
                if (!autoSpinActive) {
                    autoSpinActive = true;
                    autoSpinBtn.classList.add("active");
                    autoSpinBtn.textContent = "STOP AUTO";

                    autoSpinInterval = setInterval(() => {
                        if (!isSpinning && balance >= currentBet) spinReels();
                        else if (balance < currentBet) stopAutoSpin();
                    }, 2500);
                } else {
                    stopAutoSpin();
                }
            });
        }

        function stopAutoSpin() {
            autoSpinActive = false;
            autoSpinBtn.classList.remove("active");
            autoSpinBtn.textContent = "AUTO SPIN";
            clearInterval(autoSpinInterval);
        }

        function updateDisplay() {
            balanceElement.textContent = formatRupiah(balance);
            betElement.textContent = formatRupiah(currentBet);
            spinBtn.disabled = balance < currentBet || isSpinning;
        }

        function changeBet(amount) {
            const newBet = currentBet + amount;
            if (newBet >= 100 && newBet <= 10000000000000000) {
                currentBet = newBet;
                updateDisplay();
            }
        }

        function generatePaytable() {
            const paytableItems = document.querySelector('.paytable-items');
            const paytableData = [
                { symbol: 'assets/tile1.jpg', name: 'Mahjong Red', payout: '50x' },
                { symbol: 'assets/tile2.jpg', name: 'Mahjong Green', payout: '30x' },
                { symbol: 'assets/tile3.jpg', name: 'Mahjong White', payout: '25x' },
                { symbol: scatterSymbol, name: 'Scatter Celebration', payout: 'Free Spins' },
                { symbol: wildSymbol, name: 'Wild Fortune', payout: 'Substitutes All' },
                { symbol: jackpotSymbol, name: 'Jackpot Angpao', payout: '1000x' }
            ];

            paytableItems.innerHTML = '';
            paytableData.forEach(item => {
                const paytableItem = document.createElement('div');
                paytableItem.className = 'paytable-item';

                const symbol = document.createElement('div');
                symbol.className = 'paytable-symbol';
                symbol.innerHTML = `<img src="${item.symbol}" alt="${item.name}" class="tile-image">`;

                const details = document.createElement('div');
                details.className = 'paytable-details';

                const name = document.createElement('div');
                name.className = 'paytable-name';
                name.textContent = item.name;

                const payout = document.createElement('div');
                payout.className = 'paytable-payout';
                payout.textContent = item.payout;

                details.appendChild(name);
                details.appendChild(payout);
                paytableItem.appendChild(symbol);
                paytableItem.appendChild(details);
                paytableItems.appendChild(paytableItem);
            });
        }

        function initializeReels() {
            reelsContainer.innerHTML = '';

            for (let i = 0; i < 9; i++) {
                const reel = document.createElement('div');
                reel.className = 'reel';
                reel.id = `reel${i}`;

                const reelInner = document.createElement('div');
                reelInner.className = 'reel-inner';

                const tile = document.createElement('div');
                tile.className = 'tile';

                const symbol = getRandomSymbol();
                tile.dataset.symbol = symbol;
                tile.innerHTML = `<img src="${symbol}" class="tile-image">`;

                reelInner.appendChild(tile);
                reel.appendChild(reelInner);
                reelsContainer.appendChild(reel);
            }
        }

        function spinReels() {
            if (isSpinning || balance < currentBet) return;
            isSpinning = true;
            stopSpin = false;

            playSound('spin');
            balance -= currentBet;
            updateDisplay();

            const reels = document.querySelectorAll('.reel .reel-inner');
            const isWinningSpin = Math.random() < CHANCE_TO_WIN / 100;

            const spinPromises = Array.from(reels).map((reel, index) => {
                return new Promise(resolve => {
                    const spinDuration = 600 + index * 120;
                    let startTime = null;

                    const spin = (timestamp) => {
                        if (stopSpin) {
                            finalizeReel(reel, index);
                            return resolve();
                        }

                        if (!startTime) startTime = timestamp;
                        const elapsed = timestamp - startTime;
                        const progress = Math.min(1, elapsed / spinDuration);
                        const rotation = progress * 720;

                        reel.style.transform = `rotateX(${rotation}deg)`;

                        if (elapsed < spinDuration) {
                            requestAnimationFrame(spin);
                        } else {
                            finalizeReel(reel, index);
                            resolve();
                        }
                    };

                    requestAnimationFrame(spin);
                });
            });

            Promise.all(spinPromises).then(() => {
                if (isWinningSpin) {
                    forceWinRow();
                }

                isSpinning = false;
                updateDisplay();
                checkWins();
            });
        }

        function getRandomSymbol() {
            const rand = Math.random();
            if (rand < 0.005) return jackpotSymbol;
            if (rand < 0.04) return scatterSymbol;
            if (rand < 0.10) return wildSymbol;
            return tiles[Math.floor(Math.random() * tiles.length)];
        }

        function forceWinRow() {
            const payline = PAYLINES[Math.floor(Math.random() * PAYLINES.length)];
            const pickRand = Math.random();
            let winSymbol;
            if (pickRand < 0.05) winSymbol = jackpotSymbol;
            else if (pickRand < 0.20) winSymbol = wildSymbol;
            else if (pickRand < 0.35) winSymbol = scatterSymbol;
            else winSymbol = tiles[Math.floor(Math.random() * tiles.length)];

            payline.forEach(idx => {
                const tileDiv = document.querySelectorAll('.reel .tile')[idx];
                if (!tileDiv) return;
                tileDiv.dataset.symbol = winSymbol;
                tileDiv.innerHTML = `<img src="${winSymbol}" class="tile-image">`;
                tileDiv.classList.add('force-win');
            });
        }

        function finalizeReel(reel, index) {
            reel.style.transform = 'rotateX(0deg)';
            const tile = reel.querySelector('.tile');

            const symbol = getRandomSymbol();
            tile.dataset.symbol = symbol;
            tile.innerHTML = `<img src="${symbol}" class="tile-image">`;
            tile.className = 'tile';
        }

        function checkWins() {
            const tilesDOM = document.querySelectorAll('.reel .tile');
            const results = Array.from(tilesDOM).map(tile => ({
                symbol: tile.dataset.symbol,
                element: tile
            }));

            let winAmount = 0;
            let hasScatter = false;
            let hasJackpot = false;

            const scatterCount = results.filter(r => r.symbol === scatterSymbol).length;
            if (scatterCount >= 3) {
                hasScatter = true;
                triggerScatterEffect();
                winAmount += currentBet * scatterCount * 3;
            }

            const jackpotCount = results.filter(r => r.symbol === jackpotSymbol).length;
            if (jackpotCount >= 3) {
                hasJackpot = true;
                triggerJackpotEffect();
                winAmount += currentBet * 1000;
            }

            PAYLINES.forEach(line => {
                const lineTiles = line.map(i => results[i]).filter(Boolean);
                if (lineTiles.length !== 3) return;

                let baseSymbol = lineTiles.find(t => t.symbol !== wildSymbol)?.symbol || lineTiles[0].symbol;
                const allMatch = lineTiles.every(t => (t.symbol === baseSymbol) || (t.symbol === wildSymbol) || (baseSymbol === wildSymbol));

                if (allMatch) {
                    let multiplier = 1;
                    if (baseSymbol === jackpotSymbol) multiplier = 1000;
                    else if (baseSymbol === scatterSymbol) multiplier = 10;
                    else if (baseSymbol === wildSymbol) multiplier = 8;
                    else multiplier = 5;

                    winAmount += currentBet * multiplier;

                    lineTiles.forEach(t => {
                        t.element.classList.add('win-highlight');
                        t.element.classList.add('tile-break');
                        t.element.style.zIndex = '100';
                    });

                    triggerComboEffect(lineTiles.map(t => t.element));
                }
            });

            if (winAmount > 0) {
                balance += winAmount;
                showWinEffect(winAmount, hasJackpot);
                playSound(hasJackpot ? 'jackpot' : 'win');
            }

            updateDisplay();
        }

        function triggerScatterEffect() {
            const effect = document.createElement('div');
            effect.className = 'scatter-effect';
            effect.style.position = 'fixed';
            effect.style.top = '0';
            effect.style.left = '0';
            effect.style.width = '100vw';
            effect.style.height = '100vh';
            effect.style.pointerEvents = 'none';
            effect.style.zIndex = '9998';
            document.body.appendChild(effect);

            for (let i = 0; i < 5; i++) {
                const circle = document.createElement('div');
                circle.style.position = 'absolute';
                circle.style.width = '100px';
                circle.style.height = '100px';
                circle.style.borderRadius = '50%';
                circle.style.background = 'radial-gradient(circle, #FFD700, transparent)';
                circle.style.opacity = '0.7';
                circle.style.filter = 'blur(10px)';
                circle.style.left = `${Math.random() * 100}%`;
                circle.style.top = `${Math.random() * 100}%`;
                circle.style.animation = 'scatterPulse 1s ease-out';
                effect.appendChild(circle);
            }

            effect.style.opacity = 1;
            setTimeout(() => effect.remove(), 1500);
        }

        function triggerJackpotEffect() {
            const jackpotText = document.createElement('div');
            jackpotText.style.position = 'fixed';
            jackpotText.style.top = '50%';
            jackpotText.style.left = '50%';
            jackpotText.style.transform = 'translate(-50%, -50%)';
            jackpotText.style.fontSize = 'clamp(3rem, 10vw, 5rem)';
            jackpotText.style.color = '#FFD700';
            jackpotText.style.textShadow = '0 0 10px #FF4500, 0 0 20px #FF0000';
            jackpotText.style.opacity = '0';
            jackpotText.style.zIndex = '9999';
            jackpotText.textContent = 'ðŸŽ† JACKPOT ðŸŽ†';
            document.body.appendChild(jackpotText);

            jackpotText.animate([
                { opacity: 0, transform: 'translate(-50%, -50%) scale(0.5)' },
                { opacity: 1, transform: 'translate(-50%, -50%) scale(1.2)' },
                { opacity: 0, transform: 'translate(-50%, -50%) scale(1)' }
            ], { duration: 2000, easing: 'ease-out' });

            setTimeout(() => jackpotText.remove(), 2500);
            playSound('jackpot');
        }

        function showWinEffect(amount, isJackpot = false) {
            const winWords = ["Amazing!", "Incredible!", "Mega Win!", "Superb!", "Good!", "Unbelievable!", "Fantastic!", "Zeus Bless You!", "Gacor King!!!"];
            const randomWord = isJackpot ? "ðŸ’¥ JACKPOT!!! ðŸ’¥" : winWords[Math.floor(Math.random() * winWords.length)];

            const overlay = document.createElement('div');
            overlay.className = 'win-overlay';
            document.body.appendChild(overlay);

            const img = document.createElement('img');
            img.src = isJackpot ? 'assets/jackpot_effect.gif' : 'assets/win_effect.gif';
            img.className = 'win-effect-img';
            overlay.appendChild(img);

            const text = document.createElement('div');
            text.className = 'win-text';
            text.innerHTML = `${randomWord}<br><span class="win-amount">+${formatRupiah(amount)}</span>`;
            overlay.appendChild(text);

            playSound(isJackpot ? 'jackpot' : 'win');

            setTimeout(() => {
                overlay.classList.add('fade-out');
                setTimeout(() => overlay.remove(), 1000);
            }, 2000);
        }

        function triggerComboEffect(rowElements) {
            rowElements.forEach(tile => {
                tile.style.position = 'relative';
                tile.style.zIndex = '100';
                tile.style.animation = 'comboZoom 1.2s ease-in-out';

                tile.animate([
                    { filter: 'brightness(1)', transform: 'scale(1)' },
                    { filter: 'brightness(2) drop-shadow(0 0 20px red)', transform: 'scale(1.3)' },
                    { filter: 'brightness(1)', transform: 'scale(1)' }
                ], { duration: 1200, easing: 'ease-in-out' });
            });
        }

        initGame();
    </script>
</body>

</html>
```